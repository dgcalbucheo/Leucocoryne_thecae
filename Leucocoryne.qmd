---
title: "Leucocoryne"
format: html
---

#Paquetes y datos
```{r}
#| message: false
#| warning: false
#| include: false
required_packages <- c(
  "tidyverse", "here", "FSA", "rcompanion"
)

lapply(required_packages, function(pkg) {
  if (!require(pkg, character.only = TRUE)) install.packages(pkg)
  library(pkg, character.only = TRUE)
})
```


```{r}
#### Dataframe
df <- read.csv(here("Datos.csv"), sep =";")

head(df)
```

##NAs
```{r}
# Diagnóstico 
colSums(is.na(df))
df$ST <- droplevels(factor(df$ST))
with(df, table(ST, Dehiscence, useNA = "ifany"))

# Limpiar NAs
df <- subset(df, !is.na(ST) & !is.na(Dehiscence))
df$ST <- droplevels(df$ST)  # por si algún ST quedó vacío
```


#Modelo
```{r}
# 2) Kruskal–Wallis global
kruskal.test(Dehiscence ~ ST, data = df)

# 3) Post hoc Dunn con Bonferroni
dunn_res <- dunnTest(Dehiscence ~ ST, data = df, method = "bonferroni")

# 4) Extraer letras de agrupamiento
letters <- cldList(P.adj ~ Comparison,
                   data = dunn_res$res,
                   threshold = 0.05)

letters
```










